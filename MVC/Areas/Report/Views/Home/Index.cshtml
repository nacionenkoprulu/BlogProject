@model HomeIndexViewModel
@*Generated by ScaffoldApp.*@
@*Model namespace using directive should be added to _ViewImports.cshtml.*@

@{
    ViewData["Title"] = "Report";
}


<partial name="_Filters" model="Model"/>

<hr />

<partial name="_Report" model="Model.Reports" />


@section Scripts {

    <script src="~/lib/jquery-ajax-unobtrusive/jquery.unobtrusive-ajax.min.js"></script> @* AJAX işlemleri için mutlaka eklenmesi gerekiyor *@
    
    <link href="~/lib/jquery-datetimepicker/jquery.datetimepicker.min.css" rel="stylesheet" />
    <script src="~/lib/jquery-datetimepicker/jquery.datetimepicker.full.min.js"></script>

    <script>
        $(function () {
            $("#clear").click(function (event) {
                event.preventDefault(); //Yönlendirmeyi devredışı bıraktık.
                $(".textbox").val("");
                $("#roles").val("");
                $("#users").val("");
                $("#form").submit();
            });

            $(".dateTimePicker").datetimepicker(); //Tarih kısmını dolduran fonksiyon.

            $("#roles").change(function () {
                $("#users").empty();
                $("#users").append('<option value="">--All Users1--</option>');    
                var selectedRoleId = $("#roles").val();
                if (selectedRoleId != "") {
                    $.getJSON( //AJAX Method- Sunucuya istek atıyoruz.
                        "/Users/GetUsersByRole", //isteğin gönderileceği URL
                        {roleId: selectedRoleId}, //gönderilecek parametere
                        function (users) { //success
                            for (const user of users) {
                                $("#users").append('<option value="' + user.id + '">' + user.userName + '</option>');
                            }
                        }
                    )
                }

            });


        });

    </script>

}